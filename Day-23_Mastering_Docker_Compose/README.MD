# Mastering Docker Compose âš” | Docker Compose Zero To Hero ğŸ³

## âš™ï¸ What is Docker Compose?

**Docker Compose** is a powerful tool that simplifies managing **multi-container Docker applications**.  
Instead of running multiple `docker run` commands manually, you define all your services (like frontend, backend, and database) in a **single YAML file** and launch them together.  

ğŸ‘‰ With just one command:
```bash
docker-compose up -d
````
You can spin up an entire application stack!

---
### **Disadvantages of Docker Run Command.**

- ğŸ§© **Harder to Manage Multi-Container Applications** â€“ You must manually start and link each container individually.
- âš™ï¸ **No Central Configuration** â€“ All options must be specified in every command instead of a shared config file.  
- ğŸ” **Difficult to Reproduce and Maintain** â€“ Recreating setups requires retyping or scripting long commands.  
- ğŸ§  **Limited Environment Variable and Network Management** â€“ Manual setup is needed for networking and environment sharing.  
- ğŸª£ **No Built-In Service Dependencies** â€“ Thereâ€™s no native way to define or control container startup order.  
- ğŸ§¹ **Harder Cleanup** â€“ Stopping and removing multiple containers must be done one by one.  
- ğŸ“ˆ **Limited Scalability** â€“ Scaling services requires running and managing multiple commands manually.

---
## ğŸ§© Core Components of Docker Compose

Docker Compose revolves around three main building blocks:

- ğŸ§± 1. Services: A **service** represents a container. You define them in `docker-compose.yml` or  `ompose.yml` â€” specifying the **image**, **build context**, **ports**, **environment variables**, and more.
- ğŸŒ 2. Networks: Compose automatically creates a **default network** so services can talk to each other using container names.
You can also define **custom networks** for better isolation or organization.
- ğŸ’¾ 3. Volumes: To **persist data** (like database files), Compose allows you to create and mount **volumes** easily â€” ensuring your data survives container restarts.

---
## ğŸŒŸ Why Use Docker Compose?

- ğŸ”§ **Simplified Control:** Define, configure, and manage multiple services in a single YAML file â€” no complex orchestration commands needed.
- ğŸ‘¥ **Efficient Collaboration:** Easily share your `docker-compose.yml` file with your team â€” ensuring everyone runs the same setup.
- âš¡ **Rapid Development:** Compose **reuses existing containers** when no changes are made â€” making restarts super fast during development.
- ğŸŒ **Portability Across Environments:** Use environment variables to customize configurations for **development**, **staging**, and **production** effortlessly.
- ğŸ’¬ **Strong Community Support:** With a large community and extensive documentation, youâ€™ll find countless tutorials, examples, and troubleshooting help online.

---

## ğŸš€ Docker Compose Benefits

- âœ… Fast and easy configuration with **YAML scripts**
- âœ… **Single-host** deployment made simple
- âœ… Boosted **developer productivity**
- âœ… Enhanced **security** through isolated containers

---

## ğŸ§° Prerequisites
Before using Docker Compose, make sure Docker and Compose are installed ğŸ‘‡

- ğŸ‹ Install Docker: ğŸ”— [Docker Engine Installation Guide](https://docs.docker.com/engine/install/)
- ğŸ“¦ Install Docker Compose: ğŸ”— [Docker Compose Releases](https://github.com/docker/compose/releases)
- ğŸ“¦ Run the following commands to install Docker manually:

```bash
cd /tmp && curl -fsSL https://get.docker.com -o get-docker.sh
sudo bash get-docker.sh
sudo usermod $(whoami) -G docker -a
```

- ğŸ“¦ Run the following commands to install Compose manually:

```bash
#!/bin/bash
compose_version=$(curl https://api.github.com/repos/docker/compose/releases/latest | jq .name -r)
output='/usr/local/bin/docker-compose'
sudo curl -L https://github.com/docker/compose/releases/download/$compose_version/docker-compose-$(uname -s)-$(uname -m) -o $output
sudo chmod +x $output
sudo cp -a /usr/local/bin/docker-compose /usr/bin/docker-compose
echo $(docker-compose --version)
# Install plugins
sudo apt-get install docker-compose-plugin
# Test the installation.
docker compose version
```

---
## ğŸ§¾ Versions of Docker Compose **(Obsoleted)**
In older Compose files, the **version field** specified the format version â€” like `"2"`, `"2.4"`, `"3"`, or `"3.9"`.

| Version | Description                                         |
| ------- | --------------------------------------------------- |
| **2.x** | Added support for networks and volumes.             |
| **2.4** | Added condition control for dependencies.           |
| **3.x** | Designed for Swarm mode and advanced orchestration. |
| **3.9** | Latest legacy format supporting Compose V2.         |

ğŸ“ **Note:** Docker Compose version is ğŸ•°ï¸ _obsolete_ and will âŒ **not be available for future use**.
- ğŸ”— [Conversion Matrix](https://kompose.io/conversion/)
- ğŸ”— [Legacy Compose File Versions](https://docs.docker.com/reference/compose-file/legacy-versions/)

---
## ğŸ’¡ Docker Compose Examples

ğŸš€ **Docker Compose Multi-Examples** â€“ Practice Makes Perfect! ğŸ’»ğŸ› ï¸  
âš¡ Experiment, build, and conquer multi-container setups like a **true master**! ğŸ†ğŸ–¥ï¸


ğŸ³ Docker Compose Examples â€“ Step by Step Practice

Each example has a **unique YAML file name** (`demo1.yaml`, `demo2.yaml`, â€¦).  
Use the corresponding command to run it:

```bash
docker compose -f <filename> up -d
```

```yaml
# Mimimal
services:
  web:
    image: nginx:latest
```


```yaml
# Mimimal+(Add additional things)
services:
  web:
    image: nginx:latest
    ports:
      - "8080:80"
```

```yaml
# Mimimal With Build
#Dockerfile
FROM nginx:latest
RUN echo "alias ll='ls -alsh --color=auto'" >> /etc/bash.bashrc
RUN apt-get update && \
    apt-get install -y htop iputils-ping net-tools dnsutils traceroute && \
    rm -rf /var/lib/apt/lists/*
EXPOSE 80

# Compose.yaml
services:
  web:
    build:
      context: ./
      dockerfile: Dockerfile
    image: my-nginx:latest   # <â€” This sets the name/tag for the built image
    container_name: nginx # <â€” This sets the containerâ€™s name
    working_dir: /code
    ports:
      - "8080:80"
    volumes:
      - .:/code

# Build command
docker compose up --build
docker compose up -d --build
docker compose -f ./build_compose.yaml up -d --build
```


```yaml
# Mimimal+++(Add volumes)
services:
  web:
    image: nginx:latest
    ports:
      - "8080:80"
    volumes:
      - web_data:/usr/share/nginx/html

volumes:
  web_data:
```

```yaml
# Mimimal+++(Add Network)
services:
  web:
    image: nginx:latest
    ports:
      - "8080:80"
    networks:
      - webnet

networks:
  webnet:
    driver: bridge
```

```yaml
# Intermediate (Add volumes + Network)
services:
  web:
    image: nginx:latest
    ports:
      - "8080:80"
    volumes:
      - web_data:/usr/share/nginx/html
    networks:
      - webnet

volumes:
  web_data:

networks:
  webnet:
    driver: bridge
```

```yaml
# Advance 
.env_db
# PostgreSQL credentials
POSTGRES_USER=user
POSTGRES_PASSWORD=pass

# .env
COMPOSE_PROJECT_NAME=nginx_project
DOCKER_VOLUME_STORAGE=''
#NGINX_DEFAULT_CONF=''
TIMEZONE='Asia/Kolkata'

# Compose file
# Define defaults using YAML anchor
x-defaults: &defaults
  restart: unless-stopped
  logging:
    driver: local
    options:
      max-size: "10m"
      max-file: "3"

services:
  db:
    <<: *defaults
    image: postgres:alpine
    container_name: db
    env_file:
      - .env_db
    healthcheck:
      test: ["CMD-SHELL", "pg_isready -U user"]
      interval: 10s
      timeout: 5s
      retries: 5
    networks:
      nginx:
        aliases:
          - db.internal

  nginx:
    <<: *defaults
    image: my-nginx:latest
    container_name: nginx
    platform: linux/amd64  # For Apple M1 chips
    hostname: nginx
    working_dir: /usr/share/nginx/html
    depends_on:
      db:
        condition: service_healthy
    profiles:
      - ''
      - nginx
    networks:
      nginx:
        aliases:
          - web.internal
    #network_mode: host
    ports:
      - "8080:80" # Host port:Container port
    expose:
      - 80
    dns:
      - 8.8.8.8
    # Add nginx.conf and index.html manually or comment volume section.
    # volumes:
    #   - nginx_html:/usr/share/nginx/html
    volumes:
#      - ${DOCKER_VOLUME_STORAGE:-/mnt/docker-volumes}/nginx/nginx.conf:/etc/nginx/nginx.conf
      - ${DOCKER_VOLUME_STORAGE:-/mnt/docker-volumes}/nginx/html:/usr/share/nginx/html
#      - ${NGINX_DEFAULT_CONF:-./nginx/default.conf}:/etc/nginx/conf.d/default.conf
#      - ${NGINX_SSL_CERT:-./certs/self_signed_cert.pem}:/etc/nginx/ssl/server.crt # uncomment for SSL
#      - ${NGINX_SSL_KEY:-./certs/self_signed_key.pem}:/etc/nginx/ssl/server.key   # uncomment for SSL
    environment:
      - TZ=${TIMEZONE}
      - NGINX_HOST=example.com
      - NGINX_PORT=80
    # Add extra host for Docker Desktop compatibility
    extra_hosts:
      - "host.docker.internal:host-gateway"
      - "api.local:192.168.1.11"
    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost/"]
      interval: 30s
      timeout: 10s
      retries: 5
      start_period: 30s
    deploy:
      resources:
        limits:
          cpus: '0.5' # Limit to 50% of a CPU
          memory: 512M # Limit to 512MB of RAM
        reservations:
          cpus: '0.2' # Reserve 20% of a CPU
          memory: 256M # Reserve 256MB of RAM
    logging:
      driver: json-file
      options:
        max-size: "10m" # Limit log file size
        max-file: "3" # Keep a maximum of 3 log files
    # Annotations: used to identify service or its purpose or service discovery(Traefik, Docker Swarm, or Portainer) and routing and sometime query using Dockerâ€™s API.
    labels:
      version: "latest"
      description: "Deployed on 26-10-2025"
      project: frontend
      environment: production
      service.role: "reverse-proxy"
networks:
  nginx:
    driver: bridge
    name: nginx
    labels:
      - "purpose=frontend-network"
volumes:
  nginx_html:
```


```bash
# Commands
docker compose config
docker compose up -d
docker compose -f ./full_compose.yaml up -d
docker compose --profile nginx up -d

dec nginx
htop
ping db.internal
ping web.internal
traceroute db.internal
exit

docker compose down
```
---
## ğŸ’ Awesome Docker Compose Resources ğŸ“š Which Makes you Master âš”

You can find tons of real-world examples here ğŸ‘‡
- ğŸ”— [Compose Specification Website](https://compose-spec.io/)
- ğŸ”— [Docker Compose Documentation](https://docs.docker.com/compose/)
- ğŸ”— [The Compose Specification](https://github.com/compose-spec/compose-spec/blob/main/spec.md)
- ğŸ”— [Awesome Docker Compose Github](https://github.com/docker/awesome-compose)
- ğŸ”— [Awesome Docker Compose Website](https://awesome-docker-compose.com/apps)
- ğŸ”— [GitHub: ruanbekker/awesome-docker-compose](https://github.com/ruanbekker/awesome-docker-compose)
- ğŸ”— [GitHub: Haxxnet/Compose-Examples](https://github.com/Haxxnet/Compose-Examples)

---

## ğŸ” Convert Docker Run âœ Docker Compose File

Easily convert `docker run` commands to Compose files using:

- ğŸ”— [it-tools.tech Converter](https://it-tools.tech/docker-run-to-docker-compose-converter)
- ğŸ”— [Composerize](https://www.composerize.com/)

Example:

```bash
docker run -p 80:80 -v /var/run/docker.sock:/tmp/docker.sock:ro --restart always --log-opt max-size=1g nginx
https://github.com/meibraransari/ftp-server
```

---

## ğŸ› ï¸ Essential Docker Compose Commands

| Command                  | Description                                    |
| ------------------------ | ---------------------------------------------- |
| `docker-compose up -d`   | Start all services.                            |
| `docker-compose down`    | Stop and remove containers, networks, volumes. |
| `docker-compose ps`      | List running services.                         |
| `docker-compose logs`    | View logs of all services.                     |
| `docker-compose build`   | Build or rebuild services.                     |
| `docker-compose restart` | Restart all services.                          |
| `docker-compose config`  | Validate and view the full configuration.      |

---

## ğŸ§­ Best Practices

- âœ… Keep services **modular and independent**
- âœ… Use **.env files** for secrets and configs
- âœ… Always pin **specific image versions**
- âœ… Use **volumes** for persistent data
- âœ… Commit your `docker-compose.yml` file to version control
- âœ… Use **healthchecks** to monitor service readiness


---

## ğŸ¯ Final Thoughts

Docker Compose is your **gateway to mastering container orchestration**.
With just one YAML file, you can **build, manage, and scale** complex applications easily.

ğŸ’¬ **Learn it. Master it. Automate everything!**

ğŸ³ *Happy Dockering!* âš“

---

### ğŸ’¼ Connect with Me ğŸ‘‡ğŸ˜Š

* ğŸ”¥ [**YouTube**](https://www.youtube.com/@DevOpsinAction?sub_confirmation=1)
* âœï¸ [**Blog**](https://ibraransari.blogspot.com/)
* ğŸ’¼ [**LinkedIn**](https://www.linkedin.com/in/ansariibrar/)
* ğŸ‘¨â€ğŸ’» [**GitHub**](https://github.com/meibraransari?tab=repositories)
* ğŸ’¬ [**Telegram**](https://t.me/DevOpsinActionTelegram)
* ğŸ³ [**Docker Hub**](https://hub.docker.com/u/ibraransaridocker)

---

### â­ If You Found This Helpful...

***Please star the repo and share it! Thanks a lot!*** ğŸŒŸ




